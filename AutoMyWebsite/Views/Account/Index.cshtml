@model AccountViewModel
@{
    ViewData["Title"] = "Index";
    Layout = "_Layout";
    //if (Model.Id == CurrentAccount.currentAccount.Id)
    //    SomeBoolean = true;
    //}
    //bool AccountBoolean = false;
    //if (Model.Type == AutoMy.DomainModels.AccountType.Admin)
    //{
    //    AccountBoolean = true;
    //}
}


<head>
    <meta charset="UTF-8">
    <style>
        /*.UserSection {
            width: 100%;
        }
        .UserInformation {
            width: 400px;
            height: 400px;
            border: 1px solid steelblue;
            border-radius: 5px;
            margin: auto;
        }
        .UserInformation img {
            width: 150px;
            height: 150px;
            display: block;
            border-radius: 8px;
            margin: auto;
        }
        .UserInformation p {
            text-align: center;
            font-size: 20px;
        }
        .UserInformation .Name {
            font-size: 15px!important;
        }
        .UserInformation .Number {
            font-size: 13px!important;
        }
        .PostSection {
            width: 100%;
            margin: auto;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
        }
        .PostDiv {
            width: 250px;
            border: 1px solid steelblue;
            padding-bottom: 10px;
            margin-top: 20px;
        }
        .PostDiv p, .PostDiv a {
            margin-left: 10px;
        }
        .PostDiv img {
            width: 100%;
            height: 150px;
        }*/
            body,html{
        width:100%;
        height: 100vh;
        padding: 0px;
        margin: 0px;
    }



    .container-fluid{
        height: 100%;
    }

    .img{
        max-width: 100%;
    }
    .inventar-img{
        width: 600px;
        max-width: 100%;

    }

    .my-a{
        width: 100%;
        font-size: 15px;
        margin-bottom: 20px;
        margin-top: 20px;
    }

.my-col{
    text-align: left;
}

.my-choose{
    display: flex;
    flex-direction: column;
    align-self: flex-end;
}

        .my-paragraph {
        
            display:none;
        
        }
    </style>
</head>
<body onload="OnBodyLoad()">
    <main>
        @*<section class="UserSection">
            <div class="UserInformation">
               @if (Model.ImageUrl != null)
                {
                    <img src="@Model.ImageUrl" />
                }
                else
                {
                    <img src="~/Source/user-default.jpg" />
                }
                <p class="Name">@Model.FirstName @Model.LastName</p>
                <p class="Number">Number: @Model.PhoneNumber</p>
           </div>
           <div id="PostEditDiv">
                @if (SomeBoolean)
                    {
                        <a class="btn btn-primary" href="/Post/Create">Post!</a>
                        <a class="btn btn-primary" href="/Account/Edit">Edit Account</a>
                    }
                @if (AccountBoolean)
                    {
                        <a class="btn btn-primary" href="/Post/Reports">Reports</a>
                    }
              </div>
        </section>*@


        @*<section class="PostSection">
            @foreach (var post in Model.Posts)
            {
                <div class="PostDiv" id="@post.CategoryId">
                        <img src=@post.ImageUrl />
                    <p class="PostName">@post.Name</p>
                    <p id="CategoryId"></p>
                    <p class="PostPrice">Price: @post.Price$</p>
                    <p class="PostCompany">Company: @post.Company</p>
                    <p class="PostModel">Model: @post.Model</p>
                    <p class="PostPublishingYear">Year: @post.PublishingYear</p>
                    <a class="btn btn-primary" href=@Url.Action("Details", "Post", new { Postid = post.Id })>Details</a>
                </div>
            }
        </section>*@
    </main>

    <div class="container-fluid ">
        <div class="row">

            <div class="col-md-10 my-col border-bottom shadow-sm p-3 mb-5 ">
                <div>
                    @if (Model.ImageUrl != null)
                    {
                        <img class="img rounded" src="@Model.ImageUrl" width="200" />
                    }
                    else
                    {
                        <img src="~/Source/user-default.jpg" class="img rounded" width="200" />
                    }
                    <p id="UsernameP" class="my-paragraph">@Model.Username</p>

                    <h1 style="font-size: 20px;"> @Model.FirstName @Model.LastName </h1>
                </div>

            </div>
            <div class="col-md-2  my-choose border-bottom shadow-sm p-3 mb-5 ">
                <div id="PostEditDiv">
            
                </div>

               

                @*<a class="btn btn-lg btn-outline-secondary my-a" href="#"> შექმენი განცხადება </a>
                <a class="btn btn-lg btn-outline-secondary my-a" href="#"> შეცვალე შენი პროფილი</a>*@

            </div>


            <div class="col-sm-12" style="margin-top: 20%;">
                <div>
                    <hr>
                    <h1>შენი პროდუქტი</h1>
                    <hr>
                </div>

                <div class="col-sm-12">
                    <div class="row" style="padding: 0;margin: 0;">
                        @foreach (var post in Model.Posts)
                        {

                            <div class="col-md-3 my-card" style="margin-bottom: 25px;">
                                <div class="card" style="width: 20rem;">
                                    <div style="height:300px;">

                                        <img class="inventar-img" src="@post.ImageUrl1 ">
                                   
                                    </div>

                                    <div class="card-body">
                                        <h5 class="card-title">@post.Name</h5>
                                        <p class="card-text">Price: @post.Price$</p>
                                        <p class="card-text">Company: @post.Company</p>
                                        <p class="card-text">Model: @post.Model</p>
                                        <p class="card-text">Year: @post.PublishingYear</p>

                                        <a href=@Url.Action("Details", "Post", new { Postid = post.Id }) class="btn btn-outline-success">დეტალები</a>
                                    </div>
                                </div>

                            </div>
                        }

                    </div>
                </div>
            </div>
        </div>

    </div>

        <script>
        var Counter = 0;
        var username = document.querySelector("#UsernameP").textContent;
        function IsAdminOrNot()
        {
            $.ajax({
                type: "GET",
                url: "/Account/IsAccountInRole?username=@Model.Username",
                success: function (result)
                {
                    if (result)
                    {
                        document.querySelector("#PostEditDiv").innerHTML += `<a href="/Post/Reports" class="btn btn-primary" style="margin-left: 5px;">Reports</a>`
                    }
                }
            });
        }
        function PostEdit()
        {
            $.ajax({
                url: "/Account/ReturnUsername",
                success: function (result)
                {
                    if (username == result)
                    {
                        document.querySelector("#PostEditDiv").innerHTML = `<a class="btn btn-lg btn-outline-secondary my-a" href="/Post/Create">შექმენი განცხადება</a>
                        <a class="btn   btn-lg btn-outline-secondary my-a" href="/Account/Edit"> შეცვალე შენი პროფილი</a>
                        <a class="btn btn-lg btn-outline-secondary my-a" href="/Account/Details"> დეტალები შენზე </a>`;
                    }
                }
            });
        }
        var Divs = document.querySelectorAll(".PostDiv");
        var Counter = 0;
        function ReturnCategory()
        {
            Divs.forEach(o => {
                var categoryId = o.getAttribute("id");
                $.ajax({
                    url: "/Post/ReturnCategory",
                    data: { CategoryId: categoryId },
                    success: function (result) {
                        debugger;
                        o.querySelector("#CategoryId").textContent = "Category: " + result;
                    }
                });
            });
        }
        function OnBodyLoad()
        {
            PostEdit();
            IsAdminOrNot();
            ReturnCategory();
        }
        </script>
</body>